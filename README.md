# Book Recommendation Engine


## 1. Запуск демонстраційного застосунку

Для швидкого ознайомлення з роботою рекомендаційної системи можна запустити наступний скрипт:

```bash
docker build -t my-streamlit-app .

docker run -p 8501:8501 my-streamlit-app
```
Далі можна відкрити веб Юай в браузері для тестування
---

Скрипти

```bash
# для train/test/val спліту
python scripts/split.py

# для валідації метрик
python scripts/eval.py

# для валідації тренування
python scripts/train.py

```

Далі можна відкрити URL в браузері для тестування за портом 8501
---

## 2. Метод пошуку найрелевантніших категорій

Я обрав bi-directional encoder архітектуру для зіставлення книги з потенційними категоріями.

* **Ідея:** водночас відтворювати векторні представлення і для книги, і для кожної категорії, а потім вимірювати косинусну близькість між ними.
* **Переваги:**

*  дає змогу краще захоплювати контекст із обох сторін тексту
  * підвищена стійкість до нюансів — модель навчається розуміти, як саме окремі частини опису книги співвідносяться з різними категорійними ознаками.


## 3. Визначення метрик якості

Щоб оцінити реальну користь рекомендацій, ми вимірюємо:

* **Precision\@1**
  Доля ситуацій, у яких найрелевантніша (топ-1) категорія справді відповідає очікуванням користувача.

* **Precision\@5**
  Доля правильних категорій серед п’яти найвищих за прогнозом.

* **Recall\@1**
  Наскільки часто справжня (маркірована) категорія потрапляє у топ-1 рекомендацію.

* **Recall\@5**
  Наскільки часто серед п’яти рекомендацій виявляється хоча б одна правильна категорія.


## 4. Трекінг експериментів

Для прозорого та відтворюваного аналізу результатів я використовую **Weights & Biases**:


Найкраще тренування:
https://wandb.ai/urik-voevidka-ukrainian-catholic-university/sentence-transformers/runs/6uktomou?nw=nwuserurikvoevidka

## 5. Потенційне покращення: зворотний зв’язок від користувача

Щоб ще більше підвищити релевантність рекомендацій, я запроваджую механізм **онлайн-коригування**:

* Користувач бачить запропоновану категорію і може її «лайкнути» або «дизлайкнути»
* Зібрані реакції надходять у реаль­ному часі й використовуються для донавчання (fine-tuning) моделі або для коригування вагів у ранжуванні


## 6. Результати на Тест Сеті
| Метрика                   | Значення |
| :------------------------ | :------: |
| **Precision\@1 (P\@1)**   |  0.1755  |
| **Precision\@5 (P\@5)**   |  0.1085  |
| **Precision\@10 (P\@10)** |  0.0810  |
| **Recall\@1 (R\@1)**      |  0.0935  |
| **Recall\@5 (R\@5)**      |  0.2828  |
| **Recall\@10 (R\@10)**    |  0.4191  |
| **Mean AP (mAP)**         |  0.2332  |
| **Mean AP\@15 (mAP\@15)** |  0.2073  |


## 7. PCA
Для порівняння я спроектував ебмедінги натренованої і базової моделі на 2d графіку
Можна спостерігати що після тренування ембедінги стали більше розрідженими

![alt text](pca.png)

це результат ноутбуку notebooks/pca_comparison.ipynb

посилання на натреновану модель на hugging face: yuriivoievidka/microsoft_mpnet-base-librarian